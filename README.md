## 简介
这是一个可以分割出fasta格式的脚本，可以把一个物种的中不同的基因序列找出来，生成不同的fasta文件。
也可以把不同物种相同的基因的进行聚类生成fasta格式的文件，方便序列比对，建树。



## 功能
1. #### 分割序列

   功能介绍：有时候我们需要提取出整个序列单个基因的序列文件，可以用到这个功能。
   
    
   
   使用：把需要分割的fasta源文件放入src文件夹中，执行命令程序会自动执行，执行完毕会在目录里生成bulid文件夹中生成相应文件名，里面存放着相应文件分割后的单基因序列文件。

    ```shell
    python split_seq.py
    ```

2. #### gene 聚类

   功能介绍：有时候我们需要多个物种的同一个基因写入到同一个fasta文件中，此时可以用到这个命令（都是批量的，后续如果有需求会添加聚类单个基因的选项）。
   
   
   
   使用：把需要分割的fasta源文件放入src文件夹中，执行命令会在目录里生成bulid文件夹，默认名称为sequence

    ```shell
    python cluster_seq.py
    ```

3. #### merge 合并

   当时聚类了很多的单基因后得到了很多的多个物种的单基因文件，比对后又得到很多的比对后的文件，此时又要把这些只有一个基因的的序列文件合并成，一个物种的整条序列。可以用到这个功能，基本是聚类的逆向工程。为什么要写这两个功能，因为如果直接排序基因参与比对的话算法似乎不准确，得到的序列大多参差不齐，所以需要拆分这些基因单独的进行比对，然后再合并成一个物种的整个序列，得到比对好的序列，可直接拿来建树。

   

   **注意：**基因，暂时还没有写哪些单基因可以用来比对，比对必须是这个单基因所有的物种都有，且数量一定。

   

   使用：把需要合并的单基因fasta文件放入`src\sequence\`中，会在`bulid\marge`中生成合并并排序好序列的fasta文件

   ```
    python merge_seq.py
   ```

4. #### 自动标注标签

   功能介绍：有时候我们得到一个整个序列只有ATCG的序列文件，没有标注基因头信息，可以用到这个功能。

   

   需要的头信息可以在文件里面更改。或者提供csv表格，每行的第一格（`str`）为基因名称，第二格(`int`)为起始位置，第二格(`int`)为终止位置，第三格(`+/-`)为正序或互补序列。

   

   **注意：**

   - source为csv文件，格式如

    ```
    accD,61098,62831,+
    atpA,11306,12829,-
    atpB,56556,58052,-
    atpE,56158,56559,-
    ```

   - src中fasta文件未标注的序列中第一行标注结尾为  `[]`  ，没有请自行添加

   

   使用：把已经有的csv文件，添加到source文件中命名为lable.csv，把对应的基因序列文件放在src文件夹中，在终端中执行命令，执行程序可在bulid文件夹中生成标注好的fasta格式的文件

   ```shell
    python autoLable_seq.py
   ```

5. #### sort 自动排序基因序列

   功能介绍：有时候我们需要几个物种的好几个基因参与比对，但是基因的位置方向不一致，可以用到这个功能。

   

   使用：把需要排序基因的物种的fasta格式的文件放入src文件夹中，执行就可以了。会在bulid文件夹中生成相应文件名的，基因排序好后的fasta格式的文件。

   ```
    python sort_seq.py
   ```


